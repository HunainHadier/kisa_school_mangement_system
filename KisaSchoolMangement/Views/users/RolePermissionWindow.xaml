<Window x:Class="KisaSchoolMangement.Views.User.RolePermissionWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="ðŸ” Role Permissions" Height="700" Width="1100"
        WindowStartupLocation="CenterScreen"
        Background="#f5f6fa">
    <Window.Resources>
        <CollectionViewSource x:Key="PermissionsView" Source="{Binding Permissions}">
            <CollectionViewSource.GroupDescriptions>
                <PropertyGroupDescription PropertyName="Module" />
            </CollectionViewSource.GroupDescriptions>
        </CollectionViewSource>
    </Window.Resources>

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <Border Background="White" Padding="20" CornerRadius="10" BorderBrush="#e2e2e2" BorderThickness="1">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <StackPanel>
                    <TextBlock Text="Role Permissions" FontSize="24" FontWeight="Bold" Foreground="#2b2b2b" />
                    <TextBlock Text="Owner can add roles and control permissions by module." FontSize="13" Foreground="#6b6b6b" />
                </StackPanel>
                <Button Grid.Column="1" Content="ðŸ’¾ Save" Width="120" Height="36"
                        Background="#4CAF50" Foreground="White" BorderThickness="0"
                        FontWeight="SemiBold" Click="SavePermissions_Click" />
            </Grid>
        </Border>

        <Grid Grid.Row="1" Margin="0,20,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="280" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <Border Background="White" Padding="16" CornerRadius="10" BorderBrush="#e2e2e2" BorderThickness="1">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <TextBlock Text="Roles" FontSize="16" FontWeight="SemiBold" Foreground="#333" />

                    <ListBox Grid.Row="1" ItemsSource="{Binding Roles}" DisplayMemberPath="Name"
                             SelectedItem="{Binding SelectedRole}" Margin="0,10,0,10"
                             BorderBrush="#ddd" BorderThickness="1" />

                    <StackPanel Grid.Row="2">
                        <TextBlock Text="Add New Role" FontSize="13" FontWeight="SemiBold" Foreground="#333" />
                        <TextBox x:Name="txtNewRoleName" Height="30" Margin="0,6,0,4" />
                        <TextBox x:Name="txtNewRoleDescription" Height="30" Margin="0,0,0,8" />
                        <Button Content="âž• Create Role" Height="32" Background="#2196F3" Foreground="White"
                                BorderThickness="0" FontWeight="SemiBold" Click="CreateRole_Click" />
                    </StackPanel>
                </Grid>
            </Border>

            <Border Grid.Column="1" Background="White" Padding="16" Margin="20,0,0,0"
                    CornerRadius="10" BorderBrush="#e2e2e2" BorderThickness="1">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <StackPanel>
                        <TextBlock Text="Permissions" FontSize="16" FontWeight="SemiBold" Foreground="#333" />
                        <TextBlock Text="Select permissions for the selected role." FontSize="12" Foreground="#777" />
                    </StackPanel>

                    <ScrollViewer Grid.Row="1" Margin="0,12,0,0">
                        <ItemsControl ItemsSource="{Binding Source={StaticResource PermissionsView}}">
                            <ItemsControl.GroupStyle>
                                <GroupStyle>
                                    <GroupStyle.HeaderTemplate>
                                        <DataTemplate>
                                            <Border Background="#f3f5ff" Padding="6" CornerRadius="6" Margin="0,8,0,4">
                                                <TextBlock Text="{Binding Name}" FontSize="14" FontWeight="Bold" Foreground="#3949ab" />
                                            </Border>
                                        </DataTemplate>
                                    </GroupStyle.HeaderTemplate>
                                </GroupStyle>
                            </ItemsControl.GroupStyle>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border BorderBrush="#f0f0f0" BorderThickness="0,0,0,1" Padding="6,6">
                                        <StackPanel Orientation="Horizontal">
                                            <CheckBox IsChecked="{Binding IsSelected}" VerticalAlignment="Center" />
                                            <StackPanel Margin="10,0,0,0">
                                                <TextBlock Text="{Binding Name}" FontSize="13" FontWeight="SemiBold" />
                                                <TextBlock Text="{Binding Description}" FontSize="11" Foreground="#777" />
                                            </StackPanel>
                                        </StackPanel>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                </Grid>
            </Border>
        </Grid>
    </Grid>
</Window>
