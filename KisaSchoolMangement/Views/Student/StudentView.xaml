<Window x:Class="KisaSchoolMangement.Views.Student.StudentView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="🎓 Student Management System"
        Height="800" Width="1400"
        WindowStartupLocation="CenterScreen"
        Background="White"
        FontFamily="Segoe UI"
        WindowState="Maximized">

    <Window.Resources>
        <!-- DropShadow Effect -->
        <DropShadowEffect x:Key="CardShadow" BlurRadius="15" Opacity="0.1" ShadowDepth="2"/>
        <DropShadowEffect x:Key="ButtonShadow" BlurRadius="10" Opacity="0.3" ShadowDepth="2"/>

        <!-- Modern Button Style -->
        <Style x:Key="ModernButton" TargetType="Button">
            <Setter Property="Background" Value="#4A6CF7"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Height" Value="40"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Padding" Value="15,0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                CornerRadius="8"
                                BorderThickness="0">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"
                                              Margin="{TemplateBinding Padding}"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#3A5BEF"/>
                    <Setter Property="Effect" Value="{StaticResource ButtonShadow}"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Search TextBox Style -->
        <Style x:Key="SearchTextBox" TargetType="TextBox">
            <Setter Property="Background" Value="#FAFBFC"/>
            <Setter Property="BorderBrush" Value="#E1E5E9"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Height" Value="40"/>
            <Setter Property="Padding" Value="15,0,15,0"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
        </Style>

        <!-- ComboBox Style -->
        <Style x:Key="ModernComboBox" TargetType="ComboBox">
            <Setter Property="Background" Value="#FAFBFC"/>
            <Setter Property="BorderBrush" Value="#E1E5E9"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Height" Value="40"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
        </Style>

        <!-- DatePicker Style -->
        <Style x:Key="ModernDatePicker" TargetType="DatePicker">
            <Setter Property="Background" Value="#FAFBFC"/>
            <Setter Property="BorderBrush" Value="#E1E5E9"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Height" Value="40"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
        </Style>

        <!-- DataGrid Column Header Style -->
        <Style x:Key="DataGridColumnHeaderStyle" TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="#F8F9FA"/>
            <Setter Property="Foreground" Value="#2D3436"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Height" Value="45"/>
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
            <Setter Property="BorderBrush" Value="#E1E5E9"/>
            <Setter Property="Padding" Value="8,0"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
        </Style>

        <!-- DataGrid Cell Style -->
        <Style x:Key="DataGridCellStyle" TargetType="DataGridCell">
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="8,0"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="DataGridCell">
                        <Border Background="{TemplateBinding Background}" 
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Card Style for Stats -->
        <Style x:Key="StatCard" TargetType="Border">
            <Setter Property="Background" Value="White"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Padding" Value="20,15"/>
            <Setter Property="BorderBrush" Value="#E1E5E9"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Effect" Value="{StaticResource CardShadow}"/>
        </Style>
    </Window.Resources>

    <Grid Background="#F8F9FA">
        <!-- Background Gradients -->
        <Rectangle VerticalAlignment="Top" Height="200" Fill="#4A6CF7" Opacity="0.02"/>
        <Rectangle VerticalAlignment="Bottom" Height="150" Fill="#00B894" Opacity="0.02"/>

        <Grid Margin="15">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- 🎯 Header Section -->
            <Border Grid.Row="0" Background="White" CornerRadius="12" Padding="25" Margin="0 0 0 15"
                    BorderBrush="#E1E5E9" BorderThickness="1"
                    Effect="{StaticResource CardShadow}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- Logo and Title -->
                    <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                        <Border Background="#4A6CF7" CornerRadius="10" Width="50" Height="50" 
                                VerticalAlignment="Center" Margin="0 0 15 0">
                            <TextBlock Text="🎓" FontSize="20" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <StackPanel VerticalAlignment="Center">
                            <TextBlock Text="Student Management" 
                                       FontSize="22" 
                                       FontWeight="Bold" 
                                       Foreground="#2D3436"/>
                            <TextBlock Text="Manage all student records efficiently" 
                                       FontSize="14" 
                                       Foreground="#636E72"
                                       Margin="0 2 0 0"/>
                        </StackPanel>
                    </StackPanel>

                    <!-- 📊 Quick Stats -->
                    <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                        <Border Style="{StaticResource StatCard}" Width="140">
                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <Border Background="#E3F2FD" CornerRadius="8" Width="32" Height="32" 
                                        VerticalAlignment="Center" Margin="0 0 10 0">
                                    <TextBlock Text="👥" FontSize="14" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                <StackPanel>
                                    <TextBlock x:Name="txtTotalStudents" Text="0" FontSize="18" FontWeight="Bold" 
                                               Foreground="#1976D2"/>
                                    <TextBlock Text="Total Students" FontSize="11" Foreground="#546E7A"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- 🔍 Search & Filter Section -->
            <Border Grid.Row="1" Background="White" CornerRadius="12" Padding="20" Margin="0 0 0 15"
                    BorderBrush="#E1E5E9" BorderThickness="1"
                    Effect="{StaticResource CardShadow}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- Search Box -->
                    <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                        <TextBox x:Name="txtSearch" 
                                 Style="{StaticResource SearchTextBox}"
                                 Width="280"
                                 TextChanged="txtSearch_TextChanged">
                            <TextBox.ToolTip>
                                <ToolTip Content="Search students by name, GR number, class or age"/>
                            </TextBox.ToolTip>
                        </TextBox>
                        <ComboBox x:Name="cmbSearchField" 
                                  Style="{StaticResource ModernComboBox}"
                                  Width="140"
                                  SelectedIndex="0"
                                  Margin="10,0,0,0">
                            <ComboBoxItem Content="All Fields"/>
                            <ComboBoxItem Content="Name"/>
                            <ComboBoxItem Content="GR Number"/>
                            <ComboBoxItem Content="Class"/>
                            <ComboBoxItem Content="Age"/>
                            <ComboBoxItem Content="Father Name"/>
                            <ComboBoxItem Content="Guardian Name"/>
                        </ComboBox>
                        <Button Content="🔍 Search" Style="{StaticResource ModernButton}" 
                                Background="#4A6CF7" Margin="10,0,0,0" Click="btnSearch_Click"/>
                    </StackPanel>

                    <!-- Date Filter -->
                    <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center" Margin="20,0">
                        <TextBlock Text="Date Range:" VerticalAlignment="Center" FontWeight="SemiBold" Foreground="#2D3436" Margin="0,0,5,0"/>
                        <DatePicker x:Name="dpFromDate" Width="130" Height="40" FontSize="14" Style="{StaticResource ModernDatePicker}"/>
                        <TextBlock Text="to" VerticalAlignment="Center" Foreground="#636E72" Margin="5,0,5,0"/>
                        <DatePicker x:Name="dpToDate" Width="130" Height="40" FontSize="14" Style="{StaticResource ModernDatePicker}"/>
                        <Button Content="Apply" Style="{StaticResource ModernButton}" 
                                Background="#6C5CE7" Margin="10,0,0,0" Click="btnApplyDate_Click"/>
                    </StackPanel>

                    <!-- Action Buttons -->
                    <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                        <Button Content="📁 Import" Style="{StaticResource ModernButton}" 
                                Background="#00B894" Click="btnImportExcel_Click"/>
                        <Button Content="🔄 Refresh" Style="{StaticResource ModernButton}" 
                                Background="#636E72" Margin="10,0,0,0" Click="btnRefresh_Click"/>
                        <Button Content="➕ Add" Style="{StaticResource ModernButton}" 
                                Background="#0984E3" Margin="10,0,0,0" Click="btnAdd_Click"
                                Padding="20,0"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- 📊 Students DataGrid - تمام Fields کے ساتھ -->
            <Border Grid.Row="2" Background="White" CornerRadius="12" Padding="0" Margin="0 0 0 15"
                    BorderBrush="#E1E5E9" BorderThickness="1"
                    Effect="{StaticResource CardShadow}">
                <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
                    <DataGrid x:Name="StudentDataGrid"
                              AutoGenerateColumns="False"
                              CanUserAddRows="False"
                              IsReadOnly="True"
                              SelectionMode="Single"
                              Background="White"
                              BorderThickness="0"
                              RowHeight="35"
                              HeadersVisibility="Column"
                              FontSize="11"
                              ColumnHeaderStyle="{StaticResource DataGridColumnHeaderStyle}"
                              CellStyle="{StaticResource DataGridCellStyle}"
                              SelectionChanged="StudentDataGrid_SelectionChanged"
                              HorizontalScrollBarVisibility="Auto">

                        <DataGrid.Columns>
                            <!-- Basic Information -->
                            <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="40"/>
                            <DataGridTextColumn Header="GR No" Binding="{Binding GrNo}" Width="80"/>
                            <DataGridTextColumn Header="Student Name" Binding="{Binding StudentName}" Width="150"/>
                            <DataGridTextColumn Header="DOB" Binding="{Binding DOB, StringFormat=yyyy-MM-dd}" Width="80"/>
                            <DataGridTextColumn Header="Gender" Binding="{Binding Gender}" Width="60"/>
                            <DataGridTextColumn Header="Age" Binding="{Binding Age}" Width="50"/>

                            <!-- Class Information -->
                            <DataGridTextColumn Header="Class" Binding="{Binding ClassName}" Width="80"/>
                            <DataGridTextColumn Header="Section" Binding="{Binding SectionName}" Width="80"/>
                            <DataGridTextColumn Header="Admission Date" Binding="{Binding AdmissionDate, StringFormat=yyyy-MM-dd}" Width="100"/>
                            <DataGridTextColumn Header="Admission Year" Binding="{Binding AdmissionYear}" Width="80"/>
                            <DataGridTextColumn Header="Admission Class" Binding="{Binding AdmissionClass}" Width="100"/>

                            <!-- Family Information -->
                            <DataGridTextColumn Header="Father Name" Binding="{Binding FatherName}" Width="120"/>
                            <DataGridTextColumn Header="Family Code" Binding="{Binding FamilyCode}" Width="70"/>
                            <DataGridTextColumn Header="District Code" Binding="{Binding DistrictCode}" Width="70"/>
                            <DataGridTextColumn Header="Syed" Binding="{Binding IsSyed}" Width="50"/>
                            <DataGridTextColumn Header="Family Members" Binding="{Binding FamilyMembers}" Width="70"/>
                            <DataGridTextColumn Header="Child Position" Binding="{Binding ChildPosition}" Width="70"/>
                            <DataGridTextColumn Header="Student Category" Binding="{Binding StudentCategory}" Width="100"/>

                            <!-- Guardian Information -->
                            <DataGridTextColumn Header="Guardian Name" Binding="{Binding GuardianName}" Width="120"/>
                            <DataGridTextColumn Header="Guardian Phone" Binding="{Binding GuardianPhone}" Width="100"/>

                            <!-- Mother Information -->
                            <DataGridTextColumn Header="Mother Name" Binding="{Binding MotherName}" Width="120"/>
                            <DataGridTextColumn Header="Mother Phone" Binding="{Binding MotherPhone}" Width="100"/>
                            <DataGridTextColumn Header="Mother WhatsApp" Binding="{Binding MotherWhatsapp}" Width="100"/>

                            <!-- CNIC Information -->
                            <DataGridTextColumn Header="Child CNIC" Binding="{Binding ChildCNICNumber}" Width="100"/>
                            <DataGridTextColumn Header="Father CNIC" Binding="{Binding FatherCNIC}" Width="100"/>
                            <DataGridTextColumn Header="Mother CNIC" Binding="{Binding MotherCNICNumber}" Width="100"/>

                            <!-- Occupation & Income -->
                            <DataGridTextColumn Header="Father Occupation" Binding="{Binding FatherOccupation}" Width="120"/>
                            <DataGridTextColumn Header="Father Income" Binding="{Binding FatherMonthlyIncome, StringFormat={}{0:N2}}" Width="80"/>
                            <DataGridTextColumn Header="Mother Income" Binding="{Binding MotherMonthlyIncome, StringFormat={}{0:N2}}" Width="80"/>

                            <!-- Residential Information -->
                            <DataGridTextColumn Header="Home Status" Binding="{Binding HomeStatus}" Width="80"/>
                            <DataGridTextColumn Header="Address" Binding="{Binding Address}" Width="150"/>
                            <DataGridTextColumn Header="Monthly Fee" Binding="{Binding MonthlyFee, StringFormat={}{0:N2}}" Width="80"/>

                            <!-- Scholarship Information -->
                            <DataGridTextColumn Header="Scholarship Reason" Binding="{Binding ReasonOfScholarship}" Width="150"/>

                            <!-- Status Information -->
                            <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="80"/>
                            <DataGridCheckBoxColumn Header="Active" Binding="{Binding IsActive}" Width="50"/>

                            <!-- Leaving Information -->
                            <DataGridTextColumn Header="Left Month" Binding="{Binding LeftMonth}" Width="80"/>
                            <DataGridTextColumn Header="Left Date" Binding="{Binding LeftDate, StringFormat=yyyy-MM-dd}" Width="80"/>
                            <DataGridTextColumn Header="Left Reason" Binding="{Binding ReasonOfSchoolLeft}" Width="150"/>

                            <!-- Timestamps -->
                            <DataGridTextColumn Header="Created At" Binding="{Binding CreatedAt, StringFormat=yyyy-MM-dd}" Width="90"/>
                            <DataGridTextColumn Header="Updated At" Binding="{Binding UpdatedAt, StringFormat=yyyy-MM-dd}" Width="90"/>
                        </DataGrid.Columns>

                        <DataGrid.RowStyle>
                            <Style TargetType="DataGridRow">
                                <Setter Property="BorderBrush" Value="#F1F2F6"/>
                                <Setter Property="BorderThickness" Value="0,0,0,1"/>
                                <Setter Property="Background" Value="White"/>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#F8F9FA"/>
                                    </Trigger>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter Property="Background" Value="#E3F2FD"/>
                                        <Setter Property="BorderBrush" Value="#2196F3"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </DataGrid.RowStyle>
                    </DataGrid>
                </ScrollViewer>
            </Border>

            <!-- 📊 Footer Actions -->
            <Border Grid.Row="3" Background="White" CornerRadius="12" Padding="20"
                    BorderBrush="#E1E5E9" BorderThickness="1"
                    Effect="{StaticResource CardShadow}">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- Selected Student Info -->
                    <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                        <TextBlock x:Name="txtSelectedInfo" Text="No student selected" 
                                   FontSize="14" Foreground="#636E72" VerticalAlignment="Center"/>
                    </StackPanel>

                    <!-- Action Buttons -->
                    <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                        <Button Content="✏️ Edit" x:Name="btnEdit" Width="100" 
                                Style="{StaticResource ModernButton}" Background="#00B894" Click="btnEdit_Click"
                                IsEnabled="False"/>
                        <Button Content="🗑️ Delete" x:Name="btnDelete" Width="110" 
                                Style="{StaticResource ModernButton}" Background="#D63031" Margin="10,0,0,0" Click="btnDelete_Click"
                                IsEnabled="False"/>
                        <Button Content="📊 Export" x:Name="btnExport" Width="100" 
                                Style="{StaticResource ModernButton}" Background="#6C5CE7" Margin="10,0,0,0" Click="btnExportExcel_Click"/>
                        <Button Content="👁️ View Details" x:Name="btnViewDetails" Width="120" 
                                Style="{StaticResource ModernButton}" Background="#FD7E14" Margin="10,0,0,0" Click="btnViewDetails_Click"
                                IsEnabled="False"/>
                    </StackPanel>
                </Grid>
            </Border>
        </Grid>
    </Grid>
</Window>